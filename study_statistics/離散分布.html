<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計分布エクスプローラー：離散確率分布とインタラクティブな解説（完全版）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap"
        rel="stylesheet">
    <!-- KaTeX for beautiful math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #FDFBF8;
            /* Warm Neutral Background */
            color: #4A4A4A;
            scroll-behavior: smooth;
        }

        .math-display {
            font-size: 1.1rem;
            text-align: center;
            padding: 1rem;
            background-color: #f7f7f7;
            border-radius: 0.5rem;
            margin-top: 1rem;
            overflow-x: auto;
            border: 1px solid #E5E7EB;
        }

        /* Distribution Card Style (now standard display blocks) */
        .dist-card {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05);
            padding: 2rem;
            margin-bottom: 2.5rem;
        }

        /* Custom Styles for Interactive Section */
        .interactive-panel {
            background-color: #ECFDF5;
            /* Green/Teal Light Background */
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .slider-label {
            font-weight: 600;
            color: #047857;
            /* Dark Teal */
        }

        .content-body ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            padding-left: 0.5rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .content-body li {
            margin-bottom: 0.25rem;
        }

        .content-body p {
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .top-nav-button {
            padding: 0.5rem 1rem;
            background-color: #3B82F6;
            color: white;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .top-nav-button:hover {
            background-color: #2563EB;
        }

        .back-to-top-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            margin-top: 1.5rem;
            background-color: #9CA3AF;
            color: white;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }

        .back-to-top-button:hover {
            background-color: #6B7280;
        }
    </style>
</head>

<body class="antialiased">

    <header id="top-nav" class="bg-white/90 backdrop-blur-md sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <h1 class="text-2xl font-bold text-gray-800 text-center mb-4">統計分布エクスプローラー：離散確率分布</h1>
            <div class="flex flex-wrap justify-center gap-2">
                <a href="#discrete-uniform-dist" class="top-nav-button text-xs sm:text-sm">離散一様分布</a>
                <a href="#bernoulli-dist" class="top-nav-button text-xs sm:text-sm">ベルヌーイ分布</a>
                <a href="#binomial-dist" class="top-nav-button text-xs sm:text-sm">二項分布</a>
                <a href="#poisson-dist" class="top-nav-button text-xs sm:text-sm">ポアソン分布</a>
                <a href="#geometric-dist" class="top-nav-button text-xs sm:text-sm">幾何分布</a>
                <a href="#neg-binomial-dist" class="top-nav-button text-xs sm:text-sm">負の二項分布</a>
                <a href="#hyper-dist" class="top-nav-button text-xs sm:text-sm">超幾何分布</a>
            </div>
        </div>
    </header>

    <main id="top-page" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <p></p>
        <p class="text-center mt-2 text-xl text-gray-600 mb-10">
            パラメータの操作や他の分布との関連性を確認しながら、<strong>離散確率分布</strong>への理解を深めましょう。</p>

        <!-- ------------------------------------------------------------------ -->
        <!-- 6. 離散一様分布 (Discrete Uniform Distribution) - NEW INTERACTIVE -->
        <!-- ------------------------------------------------------------------ -->
        <section id="discrete-uniform-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-red-400">離散一様分布 - $DU(a, b)$</h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-red-800 mb-2">1. 概要・使用用途</h4>
                <p>サイコロの目やトランプの絵柄など、取りうる全ての離散的な結果が<strong>等しい確率</strong>で発生する場合に使用されます。<strong>ランダム性</strong>の最も基本的なモデルです。
                </p>

                <h4 class="font-bold text-lg text-red-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = \frac{1}{b-a+1} \quad (k = a, a+1, \dots, b)$$
                </div>

                <h4 class="font-bold text-lg text-red-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="a-uniform-slider" class="block text-sm slider-label">範囲の最小値 $a$: <span
                                        id="a-uniform-value">1</span></label>
                                <input id="a-uniform-slider" type="range" min="-10" max="0" value="1"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label for="b-uniform-slider" class="block text-sm slider-label">範囲の最大値 $b$: <span
                                        id="b-uniform-value">6</span></label>
                                <input id="b-uniform-slider" type="range" min="1" max="20" value="6"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = (a+b)/2$ : <span id="mean-uniform"
                                    class="font-bold text-xl text-blue-900">3.50</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = ((b-a+1)^2 - 1)/12$ : <span
                                    id="variance-uniform" class="font-bold text-xl text-green-900">2.92</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="uniformChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-red-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: 連続一様分布の離散版です。</li>
                    <li><strong>関連ワード</strong>: サイコロ、完全なランダム性、等確率</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 7. ベルヌーイ分布 (Bernoulli Distribution) - NEW INTERACTIVE -->
        <!-- ------------------------------------------------------------------ -->
        <section id="bernoulli-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-pink-400">ベルヌーイ分布 - $Ber(p)$</h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-pink-800 mb-2">1. 概要・使用用途</h4>
                <p>1回の試行で成功 ($X=1$) または失敗 ($X=0$)
                    のいずれかの結果しか得られない事象（例：コイントスの表裏、Yes/Noアンケート）に使用されます。<strong>二項分布の基礎</strong>となる最も単純な分布です。</p>

                <h4 class="font-bold text-lg text-pink-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = p^k (1-p)^{1-k} \quad (k \in \{0, 1\})$$
                </div>

                <h4 class="font-bold text-lg text-pink-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="p-bernoulli-slider" class="block text-sm slider-label">成功確率 $p$: <span
                                        id="p-bernoulli-value">0.50</span></label>
                                <input id="p-bernoulli-slider" type="range" min="0.01" max="0.99" value="0.5"
                                    step="0.01"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = p$ : <span id="mean-bernoulli"
                                    class="font-bold text-xl text-blue-900">0.50</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = p(1-p)$ : <span id="variance-bernoulli"
                                    class="font-bold text-xl text-green-900">0.25</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="bernoulliChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-pink-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: $n=1$ の<strong>二項分布</strong>と同じです。ロジスティック回帰分析の基礎です。</li>
                    <li><strong>関連ワード</strong>: ベルヌーイ試行、確率 $p$</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 1. 二項分布 (Binomial Distribution) -->
        <!-- ------------------------------------------------------------------ -->
        <section id="binomial-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-blue-400">二項分布 - $B(n, p)$</h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-blue-800 mb-2">1. 概要・使用用途</h4>
                <p>ベルヌーイ試行（結果が成功か失敗の2通りしかない試行）を独立に $n$ 回行ったときの、成功回数 $X$
                    の確率分布です。品質管理での不良品の数や、アンケート調査での賛成者の数など、「<strong>固定回数内の成功の合計</strong>」をモデル化する際に使われます。</p>

                <h4 class="font-bold text-lg text-blue-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = {n \choose k} p^k (1-p)^{n-k}$$
                    ここで、${n \choose k} = \frac{n!}{k!(n-k)!}$ です。
                </div>

                <h4 class="font-bold text-lg text-blue-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="n-binomial-slider" class="block text-sm slider-label">試行回数 $n$: <span
                                        id="n-binomial-value">10</span></label>
                                <input id="n-binomial-slider" type="range" min="5" max="50" value="10"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label for="p-binomial-slider" class="block text-sm slider-label">成功確率 $p$: <span
                                        id="p-binomial-value">0.50</span></label>
                                <input id="p-binomial-slider" type="range" min="0.01" max="0.99" value="0.5" step="0.01"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = np$ : <span id="mean-binomial"
                                    class="font-bold text-xl text-blue-900">5.00</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = np(1-p)$ : <span id="variance-binomial"
                                    class="font-bold text-xl text-green-900">2.50</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="binomialChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-blue-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: $n=1$ の場合、<strong>ベルヌーイ分布</strong>と一致します。</li>
                    <li><strong>近似</strong>: $n$ が大きく $p$ が小さい場合、<strong>ポアソン分布</strong>に近似します。</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 2. ポアソン分布 (Poisson Distribution) -->
        <!-- ------------------------------------------------------------------ -->
        <section id="poisson-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-orange-400">ポアソン分布 - $Po(\lambda)$
            </h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-orange-800 mb-2">1. 概要・使用用途</h4>
                <p>単位時間や単位空間で発生する稀な事象の回数 $X$
                    の確率分布です。電話の着信回数、交通事故の件数、ウェブサイトへのアクセス数など、<strong>一定期間内にランダムに発生する事象の回数</strong>をモデル化する際に使われます。</p>

                <h4 class="font-bold text-lg text-orange-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} \quad (k = 0, 1, 2, \dots)$$
                    ここで $\lambda$ は平均発生回数（パラメータ）です。
                </div>

                <h4 class="font-bold text-lg text-orange-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="lambda-slider" class="block text-sm slider-label">平均発生回数 $\lambda$: <span
                                        id="lambda-value">3.0</span></label>
                                <input id="lambda-slider" type="range" min="0.5" max="10" value="3" step="0.1"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = \lambda$ : <span id="mean-poisson"
                                    class="font-bold text-xl text-blue-900">3.00</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = \lambda$ : <span id="variance-poisson"
                                    class="font-bold text-xl text-green-900">3.00</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="poissonChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-orange-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: 二項分布において $n \to \infty, p \to 0, np \to \lambda$ となる極限分布です。</li>
                    <li><strong>関連性</strong>: ポアソン過程の「事象発生回数」をモデル化します。</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 3. 幾何分布 (Geometric Distribution) -->
        <!-- ------------------------------------------------------------------ -->
        <section id="geometric-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-cyan-400">幾何分布 - $Geo(p)$</h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-cyan-800 mb-2">1. 概要・使用用途</h4>
                <p>成功確率 $p$ の試行を独立に繰り返すとき、<strong>初めて成功するまでの試行回数</strong> $X$
                    の確率分布です。「<strong>最初の一回</strong>」がいつ発生するかをモデル化します。</p>

                <h4 class="font-bold text-lg text-cyan-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = p(1-p)^{k-1} \quad (k = 1, 2, 3, \dots)$$
                </div>

                <h4 class="font-bold text-lg text-cyan-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="p-geometric-slider" class="block text-sm slider-label">成功確率 $p$: <span
                                        id="p-geometric-value">0.50</span></label>
                                <input id="p-geometric-slider" type="range" min="0.05" max="0.95" value="0.5"
                                    step="0.01"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = 1/p$ : <span id="mean-geometric"
                                    class="font-bold text-xl text-blue-900">2.00</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = (1-p)/p^2$ : <span id="variance-geometric"
                                    class="font-bold text-xl text-green-900">2.00</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="geometricChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-cyan-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: 離散的な<strong>無記憶性</strong>を持つ唯一の離散分布です。連続版は<strong>指数分布</strong>です。</li>
                    <li><strong>一般化</strong>: 負の二項分布で $r=1$ の特殊ケースです。</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 4. 負の二項分布 (Negative Binomial Distribution) -->
        <!-- ------------------------------------------------------------------ -->
        <section id="neg-binomial-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-purple-400">負の二項分布 - $NB(r, p)$</h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-purple-800 mb-2">1. 概要・使用用途</h4>
                <p>$r$ 回目の成功を得るまでに<strong>必要な試行回数</strong> $X$ をモデル化する際に使われます（<strong>幾何分布の一般化</strong>）。成功回数 $r$
                    を固定し、試行回数を変量とします。</p>

                <h4 class="font-bold text-lg text-purple-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = {k-1 \choose r-1} p^r (1-p)^{k-r} \quad (k = r, r+1, \dots)$$
                </div>

                <h4 class="font-bold text-lg text-purple-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="r-neg-binomial-slider" class="block text-sm slider-label">目標成功回数 $r$:
                                    <span id="r-neg-binomial-value">5</span></label>
                                <input id="r-neg-binomial-slider" type="range" min="1" max="15" value="5"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label for="p-neg-binomial-slider" class="block text-sm slider-label">成功確率 $p$: <span
                                        id="p-neg-binomial-value">0.50</span></label>
                                <input id="p-neg-binomial-slider" type="range" min="0.1" max="0.9" value="0.5"
                                    step="0.01"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = r/p$ : <span id="mean-neg-binomial"
                                    class="font-bold text-xl text-blue-900">10.00</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] = r(1-p)/p^2$ : <span id="variance-neg-binomial"
                                    class="font-bold text-xl text-green-900">10.00</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="negBinomialChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-purple-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>特殊ケース</strong>: $r=1$ の場合、<strong>幾何分布</strong>と一致します。</li>
                    <li><strong>関連性</strong>: ポアソン分布と比較して<strong>過分散</strong>（分散が平均より大きい）を示すデータをモデル化するのによく使われます。</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

        <!-- ------------------------------------------------------------------ -->
        <!-- 5. 超幾何分布 (Hypergeometric Distribution) -->
        <!-- ------------------------------------------------------------------ -->
        <section id="hyper-dist" class="dist-card">
            <h2 class="text-3xl font-bold text-gray-700 mb-4 pb-2 border-b-2 border-yellow-400">超幾何分布 - $HG(N, K, n)$
            </h2>
            <div class="content-body">
                <h4 class="font-bold text-lg text-yellow-800 mb-2">1. 概要・使用用途</h4>
                <p>全体 $N$ 個中、特定のもの $K$ 個を含む集団から、$n$ 個を<strong>非復元抽出</strong>したときの、特定のものの個数 $X$
                    の確率分布です（例：くじ引き、品質検査）。<strong>非独立な試行</strong>の回数をモデル化します。</p>

                <h4 class="font-bold text-lg text-yellow-800 mt-4 mb-2">2. 定義式（確率質量関数）</h4>
                <div class="math-display">
                    $$P(X=k) = \frac{{K \choose k}{N-K \choose n-k}}{{N \choose n}}$$
                </div>

                <h4 class="font-bold text-lg text-yellow-800 mt-4 mb-2">3. インタラクティブ解説</h4>
                <div class="interactive-panel grid lg:grid-cols-2 gap-6">
                    <div>
                        <div class="space-y-4">
                            <div>
                                <label for="N-hyp-slider" class="block text-sm slider-label">母集団サイズ $N$: <span
                                        id="N-hyp-value">50</span></label>
                                <input id="N-hyp-slider" type="range" min="10" max="100" value="50"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label for="K-hyp-slider" class="block text-sm slider-label">成功要素数 $K$: <span
                                        id="K-hyp-value">25</span></label>
                                <input id="K-hyp-slider" type="range" min="1" max="50" value="25"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                            <div>
                                <label for="n-hyp-slider" class="block text-sm slider-label">抽出サイズ $n$: <span
                                        id="n-hyp-value">10</span></label>
                                <input id="n-hyp-slider" type="range" min="1" max="20" value="10"
                                    class="w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>
                        <div class="mt-4 p-3 bg-white rounded-lg shadow-inner">
                            <p class="text-sm text-gray-700">期待値 $E[X] = nK/N$ : <span id="mean-hyp"
                                    class="font-bold text-xl text-blue-900">5.00</span></p>
                            <p class="text-sm text-gray-700">分散 $V[X] \approx$ : <span id="variance-hyp"
                                    class="font-bold text-xl text-green-900">1.92</span></p>
                        </div>
                    </div>
                    <div>
                        <canvas id="hypergeometricChart" class="w-full h-64"></canvas>
                    </div>
                </div>

                <h4 class="font-bold text-lg text-yellow-800 mt-4 mb-2">5. 関連ワード・関連性</h4>
                <ul class="list-disc list-inside ml-4 text-gray-700 space-y-1">
                    <li><strong>関連性</strong>: 母集団 $N$ が抽出サイズ $n$ に対して非常に大きい場合、<strong>二項分布</strong>に近似されます（$K/N \approx
                        p$）。</li>
                </ul>
            </div>
            <a href="#top-page" class="back-to-top-button">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18">
                    </path>
                </svg>
                ページ上部に戻る
            </a>
        </section>

    </main>

    <script>
        // KaTeXのレンダリングを制御するヘルパー関数
        const renderMath = (element) => {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(element || document.body, {
                    delimiters: [
                        { left: '$$', right: '$$', display: true },
                        { left: '$', right: '$', display: false }
                    ],
                    throwOnError: false
                });
            } else {
                console.error("KaTeX auto-render is not loaded.");
            }
        };

        // DOMContentLoaded時にページ全体の数式をレンダリング
        document.addEventListener('DOMContentLoaded', () => {
            renderMath(document.body);
        });


        // --- 分布計算とChart.jsのヘルパー関数 ---
        const factorial = (n) => (n <= 1 ? 1 : n * factorial(n - 1));

        // 組み合わせ nCk の計算
        const combinations = (n, k) => {
            if (k < 0 || k > n) return 0;
            if (k === 0 || k === n) return 1;
            if (k > n / 2) k = n - k;
            let res = 1;
            for (let i = 1; i <= k; i++) {
                res = res * (n - i + 1) / i;
            }
            return res;
        };

        // --- 1. 二項分布のPMF ---
        const binomialPMF = (k, n, p) => {
            if (k < 0 || k > n) return 0;
            const q = 1 - p;
            return combinations(n, k) * Math.pow(p, k) * Math.pow(q, n - k);
        };

        // --- 2. ポアソン分布のPMF ---
        const poissonPMF = (k, lambda) => {
            if (k < 0) return 0;
            if (k > 150) return 0;
            return (Math.pow(lambda, k) * Math.exp(-lambda)) / factorial(k);
        };

        // --- 3. 幾何分布のPMF ---
        const geometricPMF = (k, p) => {
            if (k < 1) return 0;
            return p * Math.pow(1 - p, k - 1);
        };

        // --- 4. 負の二項分布のPMF ---
        const negBinomialPMF = (k, r, p) => {
            if (k < r) return 0;
            const q = 1 - p;
            return combinations(k - 1, r - 1) * Math.pow(p, r) * Math.pow(q, k - r);
        };

        // --- 5. 超幾何分布のPMF ---
        const hypergeometricPMF = (k, N, K, n) => {
            if (k < Math.max(0, n - (N - K)) || k > Math.min(n, K)) return 0;
            const num = combinations(K, k) * combinations(N - K, n - k);
            const den = combinations(N, n);
            return num / den;
        };

        // --- 6. 離散一様分布のPMF ---
        const uniformPMF = (k, a, b) => {
            if (k >= a && k <= b) return 1 / (b - a + 1);
            return 0;
        };

        // --- 7. ベルヌーイ分布のPMF ---
        const bernoulliPMF = (k, p) => {
            if (k === 1) return p;
            if (k === 0) return 1 - p;
            return 0;
        };

        // ------------------------------------------------------------------
        // --- チャート初期化と更新ロジック ---
        // ------------------------------------------------------------------

        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. 二項分布 ---
            const nBinomialSlider = document.getElementById('n-binomial-slider');
            const pBinomialSlider = document.getElementById('p-binomial-slider');
            const binomialCtx = document.getElementById('binomialChart').getContext('2d');
            let binomialChart = null;

            function updateBinomialChart() {
                const n = parseInt(nBinomialSlider.value);
                const p = parseFloat(pBinomialSlider.value);
                const q = 1 - p;

                document.getElementById('n-binomial-value').textContent = n;
                document.getElementById('p-binomial-value').textContent = p.toFixed(2);
                document.getElementById('mean-binomial').textContent = (n * p).toFixed(2);
                document.getElementById('variance-binomial').textContent = (n * p * q).toFixed(2);

                const labels = Array.from({ length: n + 1 }, (_, i) => i);
                const data = labels.map(k => binomialPMF(k, n, p));

                if (binomialChart) {
                    binomialChart.data.labels = labels;
                    binomialChart.data.datasets[0].data = data;
                    binomialChart.options.scales.x.max = n;
                    binomialChart.update();
                } else {
                    binomialChart = new Chart(binomialCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(34, 197, 94, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { title: { display: true, text: '成功回数 k' }, max: n } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            nBinomialSlider.addEventListener('input', updateBinomialChart);
            pBinomialSlider.addEventListener('input', updateBinomialChart);
            updateBinomialChart();

            // --- 2. ポアソン分布 ---
            const lambdaPoissonSlider = document.getElementById('lambda-slider');
            const poissonCtx = document.getElementById('poissonChart').getContext('2d');
            let poissonChart = null;

            function updatePoissonChart() {
                const lambda = parseFloat(lambdaPoissonSlider.value);

                document.getElementById('lambda-value').textContent = lambda.toFixed(1);
                document.getElementById('mean-poisson').textContent = lambda.toFixed(2);
                document.getElementById('variance-poisson').textContent = lambda.toFixed(2);

                const maxK = Math.max(15, Math.ceil(lambda + 4 * Math.sqrt(lambda)));
                const labels = Array.from({ length: maxK + 1 }, (_, i) => i);
                const data = labels.map(k => poissonPMF(k, lambda));

                if (poissonChart) {
                    poissonChart.data.labels = labels;
                    poissonChart.data.datasets[0].data = data;
                    poissonChart.options.scales.x.max = maxK;
                    poissonChart.update();
                } else {
                    poissonChart = new Chart(poissonCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(234, 179, 8, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { title: { display: true, text: '発生回数 k' }, max: maxK } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            lambdaPoissonSlider.addEventListener('input', updatePoissonChart);
            updatePoissonChart();


            // --- 3. 幾何分布 ---
            const pGeometricSlider = document.getElementById('p-geometric-slider');
            const geometricCtx = document.getElementById('geometricChart').getContext('2d');
            let geometricChart = null;

            function updateGeometricChart() {
                const p = parseFloat(pGeometricSlider.value);
                const q = 1 - p;

                document.getElementById('p-geometric-value').textContent = p.toFixed(2);
                const mean = 1 / p;
                const variance = q / (p * p);
                document.getElementById('mean-geometric').textContent = mean.toFixed(2);
                document.getElementById('variance-geometric').textContent = variance.toFixed(2);

                const maxK = Math.ceil(mean + 2 * Math.sqrt(variance));
                const labels = Array.from({ length: maxK }, (_, i) => i + 1);
                const data = labels.map(k => geometricPMF(k, p));

                if (geometricChart) {
                    geometricChart.data.labels = labels;
                    geometricChart.data.datasets[0].data = data;
                    geometricChart.options.scales.x.max = maxK;
                    geometricChart.update();
                } else {
                    geometricChart = new Chart(geometricCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(52, 211, 235, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { title: { display: true, text: '最初の成功までの試行回数 k' }, min: 1, max: maxK } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            pGeometricSlider.addEventListener('input', updateGeometricChart);
            updateGeometricChart();


            // --- 4. 負の二項分布 ---
            const rNegBinomialSlider = document.getElementById('r-neg-binomial-slider');
            const pNegBinomialSlider = document.getElementById('p-neg-binomial-slider');
            const negBinomialCtx = document.getElementById('negBinomialChart').getContext('2d');
            let negBinomialChart = null;

            function updateNegBinomialChart() {
                const r = parseInt(rNegBinomialSlider.value);
                const p = parseFloat(pNegBinomialSlider.value);
                const q = 1 - p;

                document.getElementById('r-neg-binomial-value').textContent = r;
                document.getElementById('p-neg-binomial-value').textContent = p.toFixed(2);

                const mean = r / p;
                const variance = r * q / (p * p);
                document.getElementById('mean-neg-binomial').textContent = mean.toFixed(2);
                document.getElementById('variance-neg-binomial').textContent = variance.toFixed(2);

                const maxK = Math.ceil(mean + 2 * Math.sqrt(variance));
                const labels = Array.from({ length: maxK - r + 1 }, (_, i) => i + r);
                const data = labels.map(k => negBinomialPMF(k, r, p));

                if (negBinomialChart) {
                    negBinomialChart.data.labels = labels;
                    negBinomialChart.data.datasets[0].data = data;
                    negBinomialChart.options.scales.x.min = r;
                    negBinomialChart.options.scales.x.max = maxK;
                    negBinomialChart.update();
                } else {
                    negBinomialChart = new Chart(negBinomialCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(168, 85, 247, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { title: { display: true, text: 'r回目の成功までの試行回数 k' }, min: r, max: maxK } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            rNegBinomialSlider.addEventListener('input', updateNegBinomialChart);
            pNegBinomialSlider.addEventListener('input', updateNegBinomialChart);
            updateNegBinomialChart();


            // --- 5. 超幾何分布 ---
            const NHypSlider = document.getElementById('N-hyp-slider');
            const KHypSlider = document.getElementById('K-hyp-slider');
            const nHypSlider = document.getElementById('n-hyp-slider');
            const hypergeometricCtx = document.getElementById('hypergeometricChart').getContext('2d');
            let hypergeometricChart = null;

            function updateHypergeometricChart() {
                let N = parseInt(NHypSlider.value);
                let K = parseInt(KHypSlider.value);
                let n = parseInt(nHypSlider.value);

                // パラメータの制約を強制
                if (K > N) { K = N; KHypSlider.value = N; }
                if (n > N) { n = N; nHypSlider.value = N; }
                KHypSlider.max = N;
                nHypSlider.max = N;

                document.getElementById('N-hyp-value').textContent = N;
                document.getElementById('K-hyp-value').textContent = K;
                document.getElementById('n-hyp-value').textContent = n;

                const mean = n * K / N;
                const p = K / N;
                const correctionFactor = (N - n) / (N - 1);
                const variance = n * p * (1 - p) * correctionFactor;
                document.getElementById('mean-hyp').textContent = mean.toFixed(2);
                document.getElementById('variance-hyp').textContent = variance.toFixed(2);

                const k_min = Math.max(0, n - (N - K));
                const k_max = Math.min(n, K);

                const labels = Array.from({ length: k_max - k_min + 1 }, (_, i) => i + k_min);
                const data = labels.map(k => hypergeometricPMF(k, N, K, n));

                if (hypergeometricChart) {
                    hypergeometricChart.data.labels = labels;
                    hypergeometricChart.data.datasets[0].data = data;
                    hypergeometricChart.options.scales.x.min = k_min;
                    hypergeometricChart.options.scales.x.max = k_max;
                    hypergeometricChart.update();
                } else {
                    hypergeometricChart = new Chart(hypergeometricCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(251, 191, 36, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true }, x: { title: { display: true, text: '成功要素の抽出数 k' }, min: k_min, max: k_max } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            NHypSlider.addEventListener('input', updateHypergeometricChart);
            KHypSlider.addEventListener('input', updateHypergeometricChart);
            nHypSlider.addEventListener('input', updateHypergeometricChart);
            updateHypergeometricChart();

            // --- 6. 離散一様分布 (NEW) ---
            const aUniformSlider = document.getElementById('a-uniform-slider');
            const bUniformSlider = document.getElementById('b-uniform-slider');
            const uniformCtx = document.getElementById('uniformChart').getContext('2d');
            let uniformChart = null;

            function updateUniformChart() {
                let a = parseInt(aUniformSlider.value);
                let b = parseInt(bUniformSlider.value);

                // aはbより小さくなければならない
                if (a >= b) {
                    a = b - 1;
                    aUniformSlider.value = a;
                }

                document.getElementById('a-uniform-value').textContent = a;
                document.getElementById('b-uniform-value').textContent = b;

                const mean = (a + b) / 2;
                const rangeSize = b - a + 1;
                const variance = (Math.pow(rangeSize, 2) - 1) / 12;

                document.getElementById('mean-uniform').textContent = mean.toFixed(2);
                document.getElementById('variance-uniform').textContent = variance.toFixed(2);

                const labels = Array.from({ length: rangeSize }, (_, i) => i + a);
                const data = labels.map(k => uniformPMF(k, a, b));

                if (uniformChart) {
                    uniformChart.data.labels = labels;
                    uniformChart.data.datasets[0].data = data;
                    uniformChart.options.scales.x.min = a;
                    uniformChart.options.scales.x.max = b;
                    uniformChart.update();
                } else {
                    uniformChart = new Chart(uniformCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(239, 68, 68, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 1 }, x: { title: { display: true, text: '値 k' }, min: a, max: b } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            aUniformSlider.addEventListener('input', updateUniformChart);
            bUniformSlider.addEventListener('input', updateUniformChart);
            updateUniformChart();


            // --- 7. ベルヌーイ分布 (NEW) ---
            const pBernoulliSlider = document.getElementById('p-bernoulli-slider');
            const bernoulliCtx = document.getElementById('bernoulliChart').getContext('2d');
            let bernoulliChart = null;

            function updateBernoulliChart() {
                const p = parseFloat(pBernoulliSlider.value);
                const q = 1 - p;

                document.getElementById('p-bernoulli-value').textContent = p.toFixed(2);
                document.getElementById('mean-bernoulli').textContent = p.toFixed(2);
                document.getElementById('variance-bernoulli').textContent = (p * q).toFixed(2);

                const labels = ['0 (失敗)', '1 (成功)'];
                const data = [q, p];

                if (bernoulliChart) {
                    bernoulliChart.data.datasets[0].data = data;
                    bernoulliChart.update();
                } else {
                    bernoulliChart = new Chart(bernoulliCtx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{ label: '確率 P(X=k)', data: data, backgroundColor: 'rgba(236, 72, 153, 0.7)' }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 1 }, x: { title: { display: true, text: '結果' } } }, plugins: { legend: { display: false } } }
                    });
                }
            }
            pBernoulliSlider.addEventListener('input', updateBernoulliChart);
            updateBernoulliChart();

        });
    </script>

</body>

</html>